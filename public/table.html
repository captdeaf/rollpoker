<!DOCTYPE html>
<html>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <head>
    <link rel="stylesheet" type="text/css" href="/poker.css" />
    <link rel="stylesheet" type="text/css" href="/seats.css" />
    <script type="text/javascript" src="https://www.gstatic.com/firebasejs/7.14.0/firebase-app.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/firebasejs/7.14.0/firebase-auth.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/firebasejs/7.14.0/firebase-firestore.js"></script>
    <script type="text/javascript" src="/underscore-min.js"></script>
    <script type="text/javascript" src="/jquery-3.4.1.min.js"></script>
    <script type="text/javascript" src="/table.js"></script>
    <script type="text/javascript" src="/signup.js"></script>
    <script type="text/javascript" src="/events.js"></script>
    <script type="text/javascript" src="/poker.js"></script>
  </head>
  <script type="text/template" id="adminlogin">
    <input type="text" name="adminpw" placeholder="Admin Password">
  </script>
  <script type="text/template" id="maintable">
      <div class="cardsettings" id="cardsettings"></div>
      <div class="tableopts" id="tableopts">
        <% if (game.CurrentBlinds) { %>
          <% if (game.CurrentBlinds[0]) { %>
            <div class="tinfo">SB: <tt><%= game.CurrentBlinds[0] %></tt></div>
          <% } %>
          <% if (game.CurrentBlinds[1]) { %>
            <div class="tinfo">BB: <tt><%= game.CurrentBlinds[1] %></tt></div>
          <% } %>
        <% } %>
        <% for (var seat in table.Seats) { var player = players[table.Seats[seat]]; %>
          <% if (player.State == "TURN") { %>
            <div class="tinfo">Betting: <tt><%= player.DisplayName %></tt></div>
          <% } %>
        <% } %>
        <div class="tinfo">Pot: <tt><%= table.Pot %></tt></div>
      </div>
    <% for (var seat in table.Seats) { var player = players[table.Seats[seat]]; %>
      <div id="<%= player.PlayerId %>" class="playerinfo <%= seat %> <%= player.State %>">
        <% if (player.PlayerId == table.Seats[table.Dealer]) { %>
          <div class="dealerbutton"></div>
        <% } %>
        <div class="playername"><%= player.DisplayName %><tt class="cash"><%= player.Chips %></tt></div>
        <div class="playerpiles"><%= Table.ChipStack(player.Chips) %></div>
        <div class="playerstate">
          <% if (player.State == "TURN") { %>
            BETTING
          <% } else if (player.State == "CALLED" && player.Bet == 0) { %>
            CHECKED
          <% } else { %>
            <%= player.State %>
          <% } %>
        </div>
        <div class="playerhand hand">
        <% if (player.PlayerId == Poker.PLAYER_ID) { %>
          <% _.each(Table.DecryptMyHand(player.Hand), function(cardval) { %>
            <div class="card <%= cardval %>"></div>
          <% }); %>
        <% } else { %>
          <% _.each(Table.GetHand(player.Hand), function(cardval) { %>
            <div class="card <%= cardval %>"></div>
          <% }); %>
        <% } %>
        </div>
      </div>
      <% if (player.Bet > 0) { %>
        <div class="<%= seat %>bet playerbet"><%= Table.ChipStack(player.Bet) %><tt class="betamt"><%= player.Bet %></tt></div>
      <% } %>
    <% } %>
    <% if (table) { %>
      <% if (table.Pot > 0) { %>
        <div class="pot"><%= Table.ChipStack(table.Pot) %><tt class="betamt"><%= table.Pot %></tt></div>
      <% } %>
      <% if (table.Cards && table.Cards.board) { %>
        <div class="board">
        <% _.each(table.Cards.board, function(cardval) { %>
          <div class="card <%= cardval %>"></div>
        <% }); %>
        </div>
      <% } %>
    <% } %>
  </script>
  <script type="text/template" id="tableview">
    <div id="tables"><div id="mytable" class="pokertable"></div></div>
    <div id="logscreen"></div>
    <% if (Poker.PLAYER && Poker.PLAYER.State != "BUSTED") { %>
      <div id="lower">
        <div id="myhand" class="grow myhand"></div>
        <div id="indicator" class="indicator"></div><br>
        <div id="betplaque" class="betplaque"></div>
        <div id="indicatorbar" style="display:none;"><tt id="indication"></tt><button id="cancelindicate">(Oops, Cancel)</button></div>
      </div>
    <% } %>
  </script>
  <script type="text/template" id="myhandview">
    <% _.each(Table.DecryptMyHand(player.Hand), function(cardval) { %>
      <div class="card <%= cardval %>"></div>
    <% }); %>
  </script>
  <script type="text/template" id="betplaqueview">
    <div id="mybetchips" class="betchips"></div>
    <div class="beti"><input class="betp" type="text" name="amount" value="">&nbsp;&nbsp;&nbsp;<tt class="betdesc">(Call)</tt></div>
    <div class="betbuttons">
      <button class="bet" name="betcall"> (Call)</button>
      <button class="bet" name="betsub">- BB</button>
      <button class="bet" name="betadd">+ BB</button>
    </div>
  </script>
  <script type="text/template" id="signupview">
    <h3>Players currently involved:</h3>
    <div id="signups">
    </div>
    <div class="invites" style="width: 400px; padding: 0.5em; border: 1px solid black;">
    <form id="joingameform">
      <input type="text" name="DisplayName" placeholder="Display Name" value=""><br>
      <input type="text" name="Email" placeholder="Email Address" value=""><br><i>We only use an email address once, to send an invite link to, it is never saved.</i><br>
      <button id="joingame">Send Invitation to Email</button>
    </form>
    </div>
    <button id="leavegame" class="gamebutton">Leave the Game</button>
    <button id="startgame" class="gamebutton">Start the Game!</button>
  </script>
  <script type="text/template" id="signuplist">
    <ul>
    <% for (var pid in Players) { var pl = Players[pid]; %>
      <li id="<%= pid %>">
      <div class="playername"><%= pl.DisplayName %><% if (Poker.PLAYER_ID == pid) { %> (You!)<% } %></div>
      </li>
    <% } %>
    </ul>
  </script>
  <body>
  </body>
</html>
